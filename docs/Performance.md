# Performance Tunning

## 延迟缓冲

延迟缓冲(pipeline)是一项比较通用的提高系统吞吐量的手段, 缺点是会提高单个请求的处理延时. 这项技术非常通用且常见, 例如 TCP 的 nagle 算法. 将处理流程进行分段, 并且在系统设计上进行分层时, 引入延迟缓冲技术就非常自然.

### 阈值触发缓冲

这种方法并不友好, 因为它是被动式的, 基于外界触发, 时间上不可控制, 例如标准 IO. 如果上层不再添加新的数据, 那么它将一直缓冲. 所以, 系统级设计通用不使用此项技术.

### 时间片缓冲(定时器触发)

时间片缓冲一般会结合阈值缓冲一起使用. 在实现上, 常常采用定时器, 定期检查发送缓冲, 如果不为空则进行处理(发送).

### 智能缓冲

在同时采用时间片缓冲和阈值缓冲两个手段的同时, 还对系统的状态进行采样判断(涉及采样率), 以决定是否启用缓冲. 在系统不繁忙时禁用缓冲, 可以改善单个用户的体验.
